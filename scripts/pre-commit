#!/bin/sh

# nest_core

echo "ğŸ” Linting nest_core..."
output=$(npm --prefix nest_core run lint 2>&1)
status=$?
if [ $status -ne 0 ]; then
  echo "âŒ Lint failed in nest_core"
  echo "$output"
  exit $status
fi

echo "ğŸ§ª Running tests in nest_core..."
output=$(npm --prefix nest_core run test:e2e 2>&1)
status=$?
if [ $status -ne 0 ]; then
  echo "âŒ Test failed in nest_core"
  echo "$output"
  exit $status
fi

# nest_mailer

echo "ğŸ” Linting nest_mailer..."
output=$(npm --prefix nest_mailer run lint 2>&1)
status=$?
if [ $status -ne 0 ]; then
  echo "âŒ Lint failed in nest_mailer"
  echo "$output"
  exit $status
fi

# next

echo "ğŸ” Linting next..."
output=$(npm --prefix next run lint:fix 2>&1)
status=$?
if [ $status -ne 0 ]; then
  echo "âŒ Lint failed in next"
  echo "$output"
  exit $status
fi

echo "ğŸ§ª Running tests in next..."
output=$(npm --prefix next run test 2>&1)
status=$?
if [ $status -ne 0 ]; then
  echo "âŒ Test failed in next"
  echo "$output"
  exit $status
fi

# nuxt

echo "ğŸ” Linting nuxt..."
output=$(npm --prefix nuxt run lint:fix 2>&1)
status=$?
if [ $status -ne 0 ]; then
  echo "âŒ Lint failed in nuxt"
  echo "$output"
  exit $status
fi

echo "ğŸ§ª Running tests in nuxt..."
output=$(npm --prefix nuxt run test:ci 2>&1)
status=$?
if [ $status -ne 0 ]; then
  echo "âŒ Test failed in nuxt"
  echo "$output"
  exit $status
fi

# final

echo "âœ… All checks passed!"